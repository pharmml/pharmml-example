<?xml version="1.0" encoding="UTF-8"?>
<PharmML xmlns="http://www.pharmml.org/2013/03/PharmML"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.pharmml.org/2013/03/PharmML http://www.pharmml.org/2013/03/PharmML"
    xmlns:ct="http://www.pharmml.org/2013/03/CommonTypes"
    xmlns:math="http://www.pharmml.org/2013/03/Maths"    
    writtenVersion="0.3" id="i1">
    
    <!-- MODEL NAME -->
    <ct:Name>Example 5 - estimation for growth tumor model - with NONMEM dataset</ct:Name>
    
    <ct:Description>based on A Tumor Growth Inhibition Model for Low-Grade Glioma Treated with Chemotherapy or Radiotherapy
        Benjamin Ribba, Gentian Kaloshi, Mathieu Peyre, et al. Clin Cancer Res Published OnlineFirst July 3, 2012.</ct:Description>
    
    <!-- INDEPENDENT VARIABLE -->
    <IndependentVariable symbId="t"/>

    <!-- SYMBOL DEFINITION - RESUIDUAL ERROR MODEL -->
    <ct:FunctionDefinition symbId="constantErrorModel" symbolType="real">
        <ct:FunctionArgument symbId="a" symbolType="real"/>
        <ct:Definition>
            <ct:SymbRef symbIdRef="a"/>
        </ct:Definition>
    </ct:FunctionDefinition>

    <!-- BLOCK I: MODEL DEFINITION -->
    <ModelDefinition  xmlns="http://www.pharmml.org/2013/03/ModelDefinition">
        
        <!-- PARAMETER MODEL -->
        <ParameterModel blkId="pm1">
            
            <!-- no IIV assumed for simplicity -->
            <SimpleParameter symbId="V"/>

            <SimpleParameter symbId="k"/>
            
            <SimpleParameter symbId="k">
                <ct:Assign>
                    <Equation xmlns="http://www.pharmml.org/2013/03/Maths">
                        <Binop op="divide">
                            <ct:SymbRef symbIdRef="CL"/>
                            <ct:SymbRef symbIdRef="V"/>
                        </Binop>
                    </Equation>
                </ct:Assign>
            </SimpleParameter>
            
            <SimpleParameter symbId="k21">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Q2"/>
                            <ct:SymbRef symbIdRef="V1"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </SimpleParameter>
            
            <SimpleParameter symbId="k21">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Q2"/>
                            <ct:SymbRef symbIdRef="V2"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </SimpleParameter>
            
            <SimpleParameter symbId="k13">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Q3"/>
                            <ct:SymbRef symbIdRef="V1"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </SimpleParameter>
            
            <SimpleParameter symbId="k31">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Q3"/>
                            <ct:SymbRef symbIdRef="V3"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </SimpleParameter>
            
            <SimpleParameter symbId="k">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="CL"/>
                            <ct:SymbRef symbIdRef="V"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </SimpleParameter>
        </ParameterModel>

    
        <!-- STRUCTURAL MODEL - ODEs -->
        <StructuralModel blkId="sm1">
            
<!--        ADVAN1, TRANS1 - 1-comp IV input
            compartment(cmt=1, amount=Ac, volume=V)
            iv(cmt=1)
            elimination(cmt=1, k)-->

            <ct:Variable symbolType="real" symbId="Ap1"/>
            
            <PKmacro>
                <Compartment>  
                    <!-- omitted, identical to ADVAN1 -->
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <IV>
                    <Cmt>1</Cmt>
                </IV>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </EliminationRate>
                    <EliminationRate>
                        <ct:Assign>
                            <math:Equation>
                                <math:Binop op="divide">
                                    <ct:SymbRef symbIdRef="CL"/>
                                    <ct:SymbRef symbIdRef="V"/>
                                </math:Binop>
                            </math:Equation>
                        </ct:Assign>
                    </EliminationRate>
                </Elimination>
            </PKmacro>
            
<!--        ADVAN2, TRANS1 - 1-comp 1st order input
            compartment(cmt=1, amount=Ac, volume=V)
            oral(cmt=1, ka)
            elimination(cmt=1, k)-->
            
            <PKmacro>
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <Oral>
                    <Cmt>1</Cmt>
                    <AbsorptionConstant>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="ka"/>                        
                    </AbsorptionConstant>
                </Oral>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </EliminationRate>
                </Elimination>
            </PKmacro>
            
<!--        ADVAN3, TRANS1 - 2-comp IV input
            compartment(cmt=1, amount=Ac, volume=V)
            peripheral(k12, k21, amount=Ap)
            iv(cmt=1)
            elimination(cmt=1, k)-->
            
            <PKmacro>
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <Peripheral>  
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ap"/>
                    </Amount>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k12"/>
                    </Rate>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k21"/>
                    </Rate>
                </Peripheral>
                
                <IV>
                    <Cmt>1</Cmt>
                </IV>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </EliminationRate>
                </Elimination>
            </PKmacro>
            
<!--        ADVAN4, TRANS1 – 2-comp 1st order input
            compartment(cmt=1, amount=Ac, volume=V)
            peripheral(k12, k21, amount=Ap)
            oral(cmt=1, ka)
            elimination(cmt=1, k)-->
            
            <PKmacro>
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <Peripheral>  
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ap"/>
                    </Amount>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k12"/>
                    </Rate>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k21"/>
                    </Rate>
                </Peripheral>
                
                <Oral>
                    <Cmt>1</Cmt>
                    <AbsorptionConstant>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="ka"/>                        
                    </AbsorptionConstant>
                </Oral>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </EliminationRate>
                </Elimination>
            </PKmacro>
            
            
<!--        ADVAN10, TRANS1 – 1-comp IV input with saturable elimination
            compartment(cmt=1, amount=Ac, volume=V)
            iv(cmt=1)
            elimination(cmt=1, Km, Vm)-->
            
            <PKmacro>
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <IV>
                    <Cmt>1</Cmt>
                </IV>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <MaximumEliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Vmax"/>
                    </MaximumEliminationRate>
                    <MichaelisMentenConstant>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Km"/>
                    </MichaelisMentenConstant>
                </Elimination>
            </PKmacro>
            
            
<!--        ADVAN11, TRANS1 – 3-comp IV input
            compartment(cmt=1, amount=Ac, volume=V)
            peripheral(k12, k21, amount=Ap1)
            peripheral(k13, k31, amount=Ap2)
            iv(cmt=1)
            elimination(cmt=1, k)-->
            
            <PKmacro>
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <Peripheral>  
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ap1"/>
                    </Amount>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k12"/>
                        <ct:Assign>
                            <math:Equation>
                                <math:Binop op="divide">
                                    <ct:SymbRef symbIdRef="Q2"/>
                                    <ct:SymbRef symbIdRef="V1"/>
                                </math:Binop>
                            </math:Equation>
                        </ct:Assign>
                    </Rate>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k21"/>
                        <ct:Assign>
                            <math:Equation>
                                <math:Binop op="divide">
                                    <ct:SymbRef symbIdRef="Q2"/>
                                    <ct:SymbRef symbIdRef="V2"/>
                                </math:Binop>
                            </math:Equation>
                        </ct:Assign>
                    </Rate>
                </Peripheral>
                
                <Peripheral>  
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ap2"/>
                    </Amount>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k13"/>
                        <ct:Assign>
                            <math:Equation>
                                <math:Binop op="divide">
                                    <ct:SymbRef symbIdRef="Q3"/>
                                    <ct:SymbRef symbIdRef="V1"/>
                                </math:Binop>
                            </math:Equation>
                        </ct:Assign>
                    </Rate>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k31"/>
                        <ct:Assign>
                            <math:Equation>
                                <math:Binop op="divide">
                                    <ct:SymbRef symbIdRef="Q3"/>
                                    <ct:SymbRef symbIdRef="V3"/>
                                </math:Binop>
                            </math:Equation>
                        </ct:Assign>
                    </Rate>
                </Peripheral>
                
                <IV>
                    <Cmt>1</Cmt>
                </IV>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                        <ct:Assign>
                            <math:Equation>
                                <math:Binop op="divide">
                                    <ct:SymbRef symbIdRef="CL"/>
                                    <ct:SymbRef symbIdRef="V"/>
                                </math:Binop>
                            </math:Equation>
                        </ct:Assign>
                    </EliminationRate>
                </Elimination>
            </PKmacro>
            
            <PKmacro>
                
                <!-- compartment(cmt=1, amount=Al) -->
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Al"/>                        
                    </Amount>
                </Compartment>
                
                <!-- compartment(cmt=2, amount=Ac) -->
                <Compartment>
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>                        
                    </Amount>
                </Compartment>
                
                <!-- peripheral(kij,kji) - 'i' source compartment, 'j' - peripheral compartment -->
                <!-- peripheral(k23,k32) -->
                <Peripheral>
                    <PeripheralComp>3</PeripheralComp>     
                    <SourceComp>2</SourceComp>
                    <InputRate>
                        <ct:SymbRef symbIdRef="k23"/>
                    </InputRate>
                    <OutputRate>
                        <ct:SymbRef symbIdRef="k32"/>                        
                    </OutputRate>
                </Peripheral>
                
                <!-- oral(type=1, cmt=1, ka, p=F1) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <AdminType>1</AdminType>
                    <AbsorptionConstant>
                        <ct:SymbRef symbIdRef="ka"/>                        
                    </AbsorptionConstant>
                    <PortionAmountAbsorbed>
                        <ct:SymbRef symbIdRef="p"/>
                        <ct:Assign>
                            <ct:SymbRef symbIdRef="F1"/>
                        </ct:Assign>
                    </PortionAmountAbsorbed>
                </Oral>
                
                <!-- oral(type=2, cmt=2, Tk0, p=F2) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <AdminType>2</AdminType>
                    <AbsorptionDuration>
                        <ct:SymbRef symbIdRef="Tk0"/>                        
                    </AbsorptionDuration>    
                    <PortionAmountAbsorbed>
                        <ct:SymbRef symbIdRef="p"/>
                        <ct:Assign>
                            <ct:SymbRef symbIdRef="F2"/>
                        </ct:Assign>
                    </PortionAmountAbsorbed>
                </Oral>
                
                <!-- iv(type=3, cmt=2) -->
                <IV>
                    <Cmt>2</Cmt>
                    <AdminType>3</AdminType>
                </IV>
                
                <!-- transfer(from=1, to=2, kt=kl) -->
                <Transfer>    
                    <From>1</From>
                    <To>2</To>
                    <TransferRate>
                        <ct:SymbRef symbIdRef="kt"/>
                        <ct:Assign>
                            <ct:SymbRef symbIdRef="kl"/>
                        </ct:Assign>
                    </TransferRate>
                </Transfer>
                
                <!-- elimination(cmt=1, k) -->
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRateConstant>
                        <ct:SymbRef symbIdRef="k"/>
                    </EliminationRateConstant>
                </Elimination>
                
                <!-- elimination(cmt=2, Km, Vm) -->
                <Elimination>
                    <Cmt>2</Cmt>
                    <MaximumEliminationRate>
                        <ct:SymbRef symbIdRef="Vmax"/>
                    </MaximumEliminationRate>
                    <MichaelisMentenConstant>
                        <ct:SymbRef symbIdRef="Km"/>
                    </MichaelisMentenConstant>
                </Elimination>
                
            </PKmacro>
            
<!--        ADVAN12, TRANS1 – 3-comp 1st order input
            compartment(cmt=1, amount=Ac, volume=V)
            peripheral(k12, k21, amount=Ap1)
            peripheral(k13, k31, amount=Ap2)
            oral(cmt=1, ka)
            elimination(cmt=1, k)-->
            
            
            <PKmacro>
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                    <Volume>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                    </Volume>
                </Compartment>
                
                <Peripheral>  
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ap1"/>
                    </Amount>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k12"/>
                    </Rate>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k21"/>
                    </Rate>
                </Peripheral>
                
                <Peripheral>  
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ap2"/>
                    </Amount>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k13"/>
                    </Rate>
                    <Rate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k31"/>
                    </Rate>
                </Peripheral>
                
                <Oral>
                    <Cmt>1</Cmt>
                    <AbsorptionConstant>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="ka"/>                        
                    </AbsorptionConstant>
                </Oral>
                
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </EliminationRate>
                </Elimination>
            </PKmacro>
            
            
            
            
            <!-- ORIGINAL PK MACROS -->
            <!--            [LONGITUDINAL]
            input = {F1, F2, ka, Tk0, kl, k23, k32, V, k, Vm, Km}
            PK:
            compartment(cmt=1, amount=Al)                                                   
            compartment(cmt=2, amount=Ac)
            peripheral(k23,k32)
            oral(type=1, cmt=1, ka, p=F1)
            oral(type=2, cmt=2, Tk0, p=F2)
            iv(type=3, cmt=2)
            transfer(from=1, to=2, kt=kl)
            elimination(cmt=1, k)
            elimination(cmt=2, Km, Vm)
            Cc = Ac/V-->
        
        </StructuralModel>
            
        <StructuralModel blkId="sm2">
            <ct:Variable symbolType="real" symbId="Al"/>
            <ct:Variable symbolType="real" symbId="Ac"/>
            <ct:Variable symbolType="real" symbId="Cc">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Ac"/>
                            <ct:SymbRef symbIdRef="V"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </ct:Variable>
            
            <PKmacro>
                <!-- compartment(cmt=1, amount=Al) -->
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Al"/>
                    </Amount>
                </Compartment>
                <!-- compartment(cmt=2, amount=Ac) -->
                <Compartment>
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                </Compartment>
                
                <!-- peripheral(k23,k32) -->
                <Peripheral>
                    <InputRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k23"/>
                    </InputRate>
                    <OutputRate> 
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k32"/>
                    </OutputRate>
                </Peripheral>
                
                <!-- oral(type=1, cmt=1, ka, p=F1) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <AdminType>1</AdminType>
                    <AbsorptionConstant>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="ka"/>
                    </AbsorptionConstant>
                    <PortionAmountAbsorbed>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="F1"/>
                        <!--                    <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="F1"/>
                        </ct:Assign>-->
                    </PortionAmountAbsorbed>
                </Oral>
                
                <!-- oral(type=2, cmt=2, Tk0, p=F2) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <AdminType>2</AdminType>
                    <AbsorptionDuration>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Tk0"/>
                    </AbsorptionDuration>
                    <PortionAmountAbsorbed>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="F2"/>
                    </PortionAmountAbsorbed>
                </Oral>
                
                <!-- iv(type=3, cmt=2) -->
                <IV>
                    <Cmt>1</Cmt>
                    <AdminType>1</AdminType>
                </IV>
                
                <!-- transfer(from=1, to=2, kt=kl) -->
                <Transfer>    
                    <From>1</From>
                    <To>2</To>
                    <TransferRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="kl"/>
                    </TransferRate>
                </Transfer>
                
                <!-- elimination(cmt=1, k) -->
                <Elimination>
                    <Cmt>1</Cmt>
                    <EliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </EliminationRate>
                </Elimination>
                
                <!-- elimination(cmt=2, Km, Vm) -->
                <Elimination>
                    <Cmt>2</Cmt>
                    <MaximumEliminationRate>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Vm"/>
                    </MaximumEliminationRate>
                    <MichaelisMentenConstant>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Km"/>
                    </MichaelisMentenConstant>
                </Elimination>
            </PKmacro>
            
        </StructuralModel>
        
        
        <StructuralModel blkId="sm3">
            <ct:Variable symbolType="real" symbId="Al"/>
            <ct:Variable symbolType="real" symbId="Ac"/>
            <ct:Variable symbolType="real" symbId="Cc">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Ac"/>
                            <ct:SymbRef symbIdRef="V"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </ct:Variable>
            
            <PKmacro>
                <!-- compartment(cmt=1, amount=Al) -->
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Al"/>
                    </Amount>
                </Compartment>
                <!-- compartment(cmt=2, amount=Ac) -->
                <Compartment>
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:SymbRef symbIdRef="Ac"/>
                    </Amount>
                </Compartment>
                
                <!-- peripheral(k23,k32) -->
                <Peripheral>
                    <kij>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k23"/>
                    </kij>
                    <kji> 
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k32"/>
                    </kji>
                </Peripheral>
                
                <!-- oral(type=1, cmt=1, ka, p=F1) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <Type>1</Type>
                    <Ka>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="ka"/>
                    </Ka>
                    <P>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="F1"/>
                        </ct:Assign>
                    </P>
                </Oral>
                
                <!-- oral(type=2, cmt=2, Tk0, p=F2) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <Type>2</Type>
                    <Tk0>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Tk0"/>
                    </Tk0>
                    <P>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="F2"/>
                    </P>
                </Oral>
                
                <!-- iv(type=3, cmt=2) -->
                <IV>
                    <Cmt>1</Cmt>
                    <Type>1</Type>
                </IV>
                
                <!-- transfer(from=1, to=2, kt=kl) -->
                <Transfer>    
                    <From>1</From>
                    <To>2</To>
                    <Kt>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="kl"/>
                        </ct:Assign>
                    </Kt>
                </Transfer>
                
                <!-- elimination(cmt=1, k) -->
                <Elimination>
                    <Cmt>1</Cmt>
                    <K>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                        </ct:Assign>
                    </K>
                </Elimination>
                
                <!-- elimination(cmt=2, Km, Vm) -->
                <Elimination>
                    <Cmt>2</Cmt>
                    <Km>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="Km"/>
                        </ct:Assign>
                    </Km>
                    <Vm>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="Vm"/>
                        </ct:Assign>
                    </Vm>
                </Elimination>
            </PKmacro>
            
        </StructuralModel>
        
        
<!--    compartment(cmt=1, volume=V, concentration=Cc)
        iv(cmt=1, p=amtDose/(amtDose+10), Tlag = t/(t + 10))
        elimination(cmt=1, k=0.2)
        peripheral(k12=0.6*V/(V + 0.1), k21=0.8, amount=Ap)-->
        
        <StructuralModel blkId="sm4">
            <ct:Variable symbolType="real" symbId="Ac"/>
            <ct:Variable symbolType="real" symbId="Ap"/>
            <ct:Variable symbolType="real" symbId="Cc">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Ac"/>
                            <ct:SymbRef symbIdRef="V"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </ct:Variable>
            
            <!-- compartment(cmt=1, volume=V, concentration=Cc) -->
            <Compartment>
                <Cmt>1</Cmt>
                <Volume>
                    <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                </Volume>
                <Concentration>
                    <ct:SymbRef symbIdRef="Cc"/>
                </Concentration>
            </Compartment>
            
            <!-- iv(cmt=1, p=0.1, Tlag = t/(t + 10)) -->
            <IV>
                <Cmt>1</Cmt>
                <P>
                    <ct:Assign>
                        <ct:Real>0.1</ct:Real>
                    </ct:Assign>
                </P>
                <Tlag>
                    <ct:Assign>
                        <math:Equation>
                            <math:Binop op="divide">
                                <ct:SymbRef symbIdRef="t"/>
                                <math:Binop op="plus">
                                    <ct:SymbRef symbIdRef="Cc"/>
                                    <ct:Real>10</ct:Real>
                                </math:Binop>
                            </math:Binop>
                        </math:Equation>
                    </ct:Assign>
                </Tlag>
            </IV>
            
            <!-- elimination(cmt=1, k=0.2) -->
            <Elimination>
                <Cmt>1</Cmt>
                <K>
                    <ct:Assign>
                        <ct:Real>0.2</ct:Real>
                    </ct:Assign>
                </K>
            </Elimination>
            
            <!-- peripheral(k12=0.6*V/(V + 0.1), k21=0.8, amount=Ap) -->
            <Peripheral>
                <k12>
                    <ct:Assign>
                        <math:Equation>
                            <math:Binop op="divide">
                                <math:Binop op="times">
                                    <ct:Real>0.6</ct:Real>
                                    <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                                </math:Binop>
                                <math:Binop op="plus">
                                    <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                                    <ct:Real>0.1</ct:Real>
                                </math:Binop>
                            </math:Binop>
                        </math:Equation>
                    </ct:Assign>
                </k12>
                <k21> 
                    <ct:Assign>
                        <ct:Real>0.8</ct:Real>
                    </ct:Assign>
                </k21>
                <Amount>
                    <ct:SymbRef symbIdRef="Ap"/>
                </Amount>
            </Peripheral>

        </StructuralModel>



<!--        complex example - NEW -->
        <StructuralModel blkId="sm5">
            <ct:Variable symbolType="real" symbId="Al"/>
            <ct:Variable symbolType="real" symbId="Ac"/>
            <ct:Variable symbolType="real" symbId="Cc">
                <ct:Assign>
                    <math:Equation>
                        <math:Binop op="divide">
                            <ct:SymbRef symbIdRef="Ac"/>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="V"/>
                        </math:Binop>
                    </math:Equation>
                </ct:Assign>
            </ct:Variable>
            
            <PKmacro>
                <!-- compartment(cmt=1, amount=Al) -->
                <Compartment>  
                    <Cmt>1</Cmt>
                    <Amount>
                        <ct:Assign>
                            <ct:SymbRef symbIdRef="Al"/>
                        </ct:Assign>
                    </Amount>
                </Compartment>
                
                <!-- compartment(cmt=2, amount=Ac) -->
                <Compartment>
                    <Cmt>2</Cmt>
                    <Amount>
                        <ct:Assign>
                            <ct:SymbRef symbIdRef="Ac"/>
                        </ct:Assign>
                    </Amount>
                </Compartment>
                
                <!-- peripheral(k23,k32) -->
                <Peripheral>
                    <k23>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="k23"/>
                        </ct:Assign>
                    </k23>
                    <k32>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="k32"/>
                        </ct:Assign>
                    </k32>
                </Peripheral>
                
                <!-- oral(type=1, cmt=1, ka, p=F1) -->
                <Oral>
                    <Type>1</Type>
                    <Cmt>1</Cmt>
                    <Ka>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="ka"/>
                        </ct:Assign>
                    </Ka>
                    <P>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="F1"/>
                        </ct:Assign>
                    </P>
                </Oral>
                
                <!-- oral(type=2, cmt=2, Tk0, p=F2) -->
                <Oral>
                    <Cmt>1</Cmt>
                    <AdminType>2</AdminType>
                    <Tk0>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="Tk0"/>
                        </ct:Assign>
                    </Tk0>
                    <P>
                        <ct:Assign>
                            <ct:SymbRef blkIdRef="pm1" symbIdRef="F2"/>
                        </ct:Assign>
                    </P>
                </Oral>
                
                <!-- iv(type=3, cmt=2) -->
                <IV>
                    <Cmt>2</Cmt>
                    <Type>3</Type>
                </IV>
                
                <!-- transfer(from=1, to=2, kt=kl) -->
                <Transfer>    
                    <From>1</From>
                    <To>2</To>
                    <kt>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="kl"/>
                    </kt>
                </Transfer>
                
                <!-- elimination(cmt=1, k) -->
                <Elimination>
                    <Cmt>1</Cmt>
                    <k>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="k"/>
                    </k>
                </Elimination>
                
                <!-- elimination(cmt=2, Km, Vm) -->
                <Elimination>
                    <Cmt>2</Cmt>
                    <Km>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Vm"/>
                    </Km>
                    <Vm>
                        <ct:SymbRef blkIdRef="pm1" symbIdRef="Km"/>
                    </Vm>
                </Elimination>
            </PKmacro>
            
        </StructuralModel>
        
    </ModelDefinition>


    <TrialDesign xmlns="http://www.pharmml.org/2013/03/TrialDesign">
        
        
<!--        <Structure>
            <Epoch oid="">
                <Start>
                    <ct:Real></ct:Real>
                </Start>
                <End>
                    <ct:Real></ct:Real>
                </End>
                <Order></Order>
            </Epoch>
            <Arm oid=""></Arm>
            <Cell oid="">
                <EpochRef oidRef=""></EpochRef>
                <ArmRef oidRef=""></ArmRef>
                <SegmentRef oidRef=""></SegmentRef>
            </Cell>
            <Segment oid="">
                <ActivityRef oidRef=""></ActivityRef>
            </Segment>
            <Activity oid="act1">
                <Bolus>
                    <DoseAmount inputTarget="parameter">
                        <ct:SymbRef symbIdRef="D"/>
                        <ct:Assign>
                            <ct:Real>10</ct:Real>
                        </ct:Assign>
                    </DoseAmount>
                    <DosingTimes>
                        <!-\- e.g. 10 -\->
                    </DosingTimes>
                </Bolus>
            </Activity>
            <Activity oid="act1">
                <Bolus>
                    <DoseAmount inputTarget="compartment">
                        <CompartmentNumber compNo="1"/>
                        <ct:Assign>
                            <ct:Real>10</ct:Real>
                        </ct:Assign>
                    </DoseAmount>
                    <DosingTimes>
                        <!-\- e.g. 10 -\->
                    </DosingTimes>
                </Bolus>
            </Activity>
        </Structure>
        <Population>
            <DataSet xmlns="http://www.pharmml.org/2013/08/Dataset">
                <Definition>
                    <Column columnId="" columnType="" valueType="" columnNum=""></Column>
                </Definition>
            </DataSet>
        </Population>
    </TrialDesign>-->
    
</PharmML>
